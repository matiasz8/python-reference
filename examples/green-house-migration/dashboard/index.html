<!doctype html>
<html lang="en">
  <head>
    <title>TeamTailor Sourced Candidates Analytics Dashboard</title>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <link
      rel="icon"
      type="image/svg+xml"
      href="/dashboard/static/favicon.svg"
    />
    <link
      href="https://cdn.jsdelivr.net/npm/bootstrap@5.1.3/dist/css/bootstrap.min.css"
      rel="stylesheet"
    />
    <link
      href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.0.0/css/all.min.css"
      rel="stylesheet"
    />
    <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
    <style>
      .stats-card {
        background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
        color: white;
        border-radius: 15px;
        padding: 20px;
        margin-bottom: 20px;
        box-shadow: 0 4px 15px rgba(0, 0, 0, 0.1);
      }
      .tag-badge {
        background: #007bff;
        color: white;
        padding: 4px 8px;
        border-radius: 12px;
        font-size: 0.8em;
        margin: 2px;
        display: inline-block;
      }
      .candidate-card {
        border: 1px solid #e0e0e0;
        border-radius: 10px;
        padding: 15px;
        margin-bottom: 15px;
        background: white;
        box-shadow: 0 2px 5px rgba(0, 0, 0, 0.05);
      }
      .loading {
        text-align: center;
        padding: 40px;
        color: #666;
      }
      .error {
        background: #f8d7da;
        color: #721c24;
        padding: 15px;
        border-radius: 5px;
        margin: 10px 0;
      }
      .success {
        background: #d4edda;
        color: #155724;
        padding: 15px;
        border-radius: 5px;
        margin: 10px 0;
      }
      .chart-container {
        background: white;
        border-radius: 10px;
        padding: 20px;
        margin-bottom: 20px;
        box-shadow: 0 2px 10px rgba(0, 0, 0, 0.1);
      }
      .loading-spinner {
        border: 4px solid #f3f4f6;
        border-top: 4px solid #3b82f6;
        border-radius: 50%;
        width: 40px;
        height: 40px;
        animation: spin 1s linear infinite;
      }
      @keyframes spin {
        0% {
          transform: rotate(0deg);
        }
        100% {
          transform: rotate(360deg);
        }
      }
    </style>
  </head>
  <body class="bg-light">
    <!-- Loading Screen -->
    <div
      id="loadingScreen"
      class="position-fixed top-0 start-0 w-100 h-100 bg-white d-flex align-items-center justify-content-center"
      style="z-index: 9999"
    >
      <div class="text-center">
        <div class="loading-spinner mx-auto mb-4"></div>
        <p class="text-muted fs-5">Loading analytics data...</p>
      </div>
    </div>

    <!-- Error Screen -->
    <div
      id="errorScreen"
      class="position-fixed top-0 start-0 w-100 h-100 bg-white d-flex align-items-center justify-content-center d-none"
      style="z-index: 9999"
    >
      <div class="text-center max-w-md mx-auto p-4">
        <div class="text-danger display-1 mb-4">
          <i class="fas fa-exclamation-triangle"></i>
        </div>
        <h2 class="h2 fw-bold text-dark mb-2">Oops! Something went wrong</h2>
        <p id="errorMessage" class="text-muted mb-4">
          Failed to load analytics data.
        </p>
        <button id="retryBtn" class="btn btn-primary">
          <i class="fas fa-redo me-2"></i>Try Again
        </button>
      </div>
    </div>

    <!-- Main Dashboard -->
    <div id="dashboard" class="d-none">
      <!-- Header -->
      <header class="bg-white shadow-sm border-bottom">
        <div class="container-fluid">
          <div class="d-flex justify-content-between align-items-center py-3">
            <div class="d-flex align-items-center">
              <div class="flex-shrink-0">
                <i class="fas fa-chart-line text-primary fs-2"></i>
              </div>
              <div class="ms-3">
                <h1 class="h4 fw-semibold text-dark mb-0">
                  Sourced Candidates Analytics Dashboard
                </h1>
                <p class="text-muted small mb-0">
                  Real-time insights from TeamTailor
                </p>
              </div>
            </div>
            <div class="d-flex align-items-center gap-3">
              <button id="refreshBtn" class="btn btn-primary">
                <i class="fas fa-sync-alt me-2"></i>Refresh
              </button>
              <div class="text-muted small">
                Last updated: <span id="lastUpdate">-</span>
              </div>
            </div>
          </div>
        </div>
      </header>

      <!-- Main Content -->
      <main class="container-fluid px-4 py-3">
        <!-- Overview Cards -->
        <div class="row g-4 mb-4">
          <div class="col-md-3 col-sm-6">
            <div class="stats-card">
              <div class="d-flex align-items-center">
                <div class="flex-shrink-0">
                  <div
                    class="w-8 h-8 bg-white rounded-circle d-flex align-items-center justify-content-center"
                  >
                    <i class="fas fa-users text-primary fs-4"></i>
                  </div>
                </div>
                <div class="ms-4">
                  <p class="text-white-50 text-sm mb-1">Total Candidates</p>
                  <h3 class="text-white fw-bold mb-0" id="total-candidates">
                    -
                  </h3>
                </div>
              </div>
            </div>
          </div>

          <div class="col-md-3 col-sm-6">
            <div class="stats-card">
              <div class="d-flex align-items-center">
                <div class="flex-shrink-0">
                  <div
                    class="w-8 h-8 bg-white rounded-circle d-flex align-items-center justify-content-center"
                  >
                    <i class="fas fa-tags text-success fs-4"></i>
                  </div>
                </div>
                <div class="ms-4">
                  <p class="text-white-50 text-sm mb-1">Unique Tags</p>
                  <h3 class="text-white fw-bold mb-0" id="unique-tags">-</h3>
                </div>
              </div>
            </div>
          </div>

          <div class="col-md-3 col-sm-6">
            <div class="stats-card">
              <div class="d-flex align-items-center">
                <div class="flex-shrink-0">
                  <div
                    class="w-8 h-8 bg-white rounded-circle d-flex align-items-center justify-content-center"
                  >
                    <i class="fas fa-chart-bar text-info fs-4"></i>
                  </div>
                </div>
                <div class="ms-4">
                  <p class="text-white-50 text-sm mb-1">Avg Tags/Candidate</p>
                  <h3 class="text-white fw-bold mb-0" id="avg-tags">-</h3>
                </div>
              </div>
            </div>
          </div>

          <div class="col-md-3 col-sm-6">
            <div class="stats-card">
              <div class="d-flex align-items-center">
                <div class="flex-shrink-0">
                  <div
                    class="w-8 h-8 bg-white rounded-circle d-flex align-items-center justify-content-center"
                  >
                    <i class="fas fa-chart-line text-warning fs-4"></i>
                  </div>
                </div>
                <div class="ms-4">
                  <p class="text-white-50 text-sm mb-1">Avg Engagement Rate</p>
                  <h3 class="text-white fw-bold mb-0" id="avg-engagement">-</h3>
                </div>
              </div>
            </div>
          </div>
        </div>

        <!-- Additional Metrics Cards -->
        <div class="row g-4 mb-4">
          <div class="col-md-4 col-sm-6">
            <div class="stats-card">
              <div class="d-flex align-items-center justify-content-between">
                <div>
                  <p class="text-white-50 text-sm mb-1">Migration Status</p>
                  <h3
                    class="text-white fw-bold mb-0"
                    id="migration-success-rate"
                  >
                    -
                  </h3>
                  <p class="text-white-50 text-xs mb-0">
                    <span id="migrated-count">-</span> migrated /
                    <span id="pending-count">-</span> pending
                  </p>
                </div>
                <div
                  class="w-12 h-12 bg-white rounded-circle d-flex align-items-center justify-content-center"
                >
                  <i class="fas fa-sync-alt text-primary fs-4"></i>
                </div>
              </div>
            </div>
          </div>

          <div class="col-md-4 col-sm-6">
            <div class="stats-card">
              <div class="d-flex align-items-center justify-content-between">
                <div>
                  <p class="text-white-50 text-sm mb-1">Engagement Levels</p>
                  <h3 class="text-white fw-bold mb-0" id="high-engagement">
                    -
                  </h3>
                  <p class="text-white-50 text-xs mb-0">
                    High: <span id="high-engagement-count">-</span> | Medium:
                    <span id="medium-engagement-count">-</span> | Low:
                    <span id="low-engagement-count">-</span>
                  </p>
                </div>
                <div
                  class="w-12 h-12 bg-white rounded-circle d-flex align-items-center justify-content-center"
                >
                  <i class="fas fa-bullseye text-success fs-4"></i>
                </div>
              </div>
            </div>
          </div>

          <div class="col-md-4 col-sm-6">
            <div class="stats-card">
              <div class="d-flex align-items-center justify-content-between">
                <div>
                  <p class="text-white-50 text-sm mb-1">Categories</p>
                  <h3 class="text-white fw-bold mb-0" id="total-categories">
                    -
                  </h3>
                  <p class="text-white-50 text-xs mb-0">Active categories</p>
                </div>
                <div
                  class="w-12 h-12 bg-white rounded-circle d-flex align-items-center justify-content-center"
                >
                  <i class="fas fa-layer-group text-info fs-4"></i>
                </div>
              </div>
            </div>
          </div>
        </div>

        <!-- Charts Section -->
        <div class="row g-4 mb-4">
          <!-- Tags Distribution Chart -->
          <div class="col-md-6">
            <div class="chart-container">
              <h3 class="h5 fw-semibold text-dark mb-4">
                Top Tags Distribution
              </h3>
              <div class="h-80">
                <canvas id="tagsChart"></canvas>
              </div>
            </div>
          </div>

          <!-- Engagement Rates Chart -->
          <div class="col-md-6">
            <div class="chart-container">
              <h3 class="h5 fw-semibold text-dark mb-4">
                Engagement Rates by Category
              </h3>
              <div class="h-80">
                <canvas id="completionChart"></canvas>
              </div>
            </div>
          </div>
        </div>

        <!-- Tag Distribution Chart -->
        <div class="chart-container mb-4">
          <h3 class="h5 fw-semibold text-dark mb-4">
            Sourced Candidates Tag Distribution
          </h3>
          <p class="text-muted small mb-4">
            Distribution of key tags applied to sourced candidates (prospects)
          </p>
          <div class="h-80">
            <canvas id="tagDistributionChart"></canvas>
          </div>
        </div>

        <!-- Categories Table -->
        <div class="card shadow">
          <div
            class="card-header d-flex justify-content-between align-items-center"
          >
            <h3 class="h5 fw-semibold text-dark">Candidate Categories</h3>
            <div class="d-flex gap-2">
              <input
                type="text"
                id="searchPools"
                placeholder="Search categories..."
                class="form-control form-control-sm"
              />
              <select id="sortPools" class="form-control form-control-sm">
                <option value="name">Sort by Name</option>
                <option value="candidates">Sort by Candidates</option>
                <option value="email">Sort by Email Rate</option>
              </select>
            </div>
          </div>
          <div class="table-responsive">
            <table class="table table-striped table-hover">
              <thead class="bg-light">
                <tr>
                  <th
                    class="px-3 py-2 text-left text-sm font-medium text-gray-500 uppercase tracking-wider"
                  >
                    Category
                  </th>
                  <th
                    class="px-3 py-2 text-left text-sm font-medium text-gray-500 uppercase tracking-wider"
                  >
                    Candidates
                  </th>
                  <th
                    class="px-3 py-2 text-left text-sm font-medium text-gray-500 uppercase tracking-wider"
                  >
                    Email Rate
                  </th>
                  <th
                    class="px-3 py-2 text-left text-sm font-medium text-gray-500 uppercase tracking-wider"
                  >
                    Phone Rate
                  </th>
                  <th
                    class="px-3 py-2 text-left text-sm font-medium text-gray-500 uppercase tracking-wider"
                  >
                    LinkedIn Rate
                  </th>
                  <th
                    class="px-3 py-2 text-right text-sm font-medium text-gray-500 uppercase tracking-wider"
                  >
                    Actions
                  </th>
                </tr>
              </thead>
              <tbody id="poolsTableBody" class="bg-white">
                <!-- Table rows will be populated by JavaScript -->
              </tbody>
            </table>
          </div>
        </div>
      </main>
    </div>

    <!-- Pool Details Modal -->
    <div
      id="poolModal"
      class="modal fade"
      tabindex="-1"
      aria-labelledby="poolModalLabel"
      aria-hidden="true"
    >
      <div class="modal-dialog modal-dialog-centered">
        <div class="modal-content">
          <div class="modal-header">
            <h5 class="modal-title" id="modalTitle">Pool Details</h5>
            <button
              type="button"
              class="btn-close"
              data-bs-dismiss="modal"
              aria-label="Close"
            ></button>
          </div>
          <div class="modal-body" id="modalContent">
            <!-- Modal content will be populated by JavaScript -->
          </div>
        </div>
      </div>
    </div>

    <!-- Bootstrap JS -->
    <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.1.3/dist/js/bootstrap.bundle.min.js"></script>

    <!-- Dashboard JavaScript -->
    <script src="/dashboard/static/dashboard.js"></script>
  </body>
</html>
